<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 5.4.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="format-detection" content="telephone=no"><title>Chapter 22 Elementary Graph Algorithms - duinomaker&#39;s blog</title><meta name="description" content="Solutions to exercises in Introduction to Algorithms chapter 22 - Elementary Graph Algorithms"><meta property="og:type" content="website"><meta property="og:title" content="Chapter 22 Elementary Graph Algorithms"><meta property="og:url" content="https://duinomaker.top/CLRS/exercises/22/"><meta property="og:site_name" content="duinomaker&#39;s blog"><meta property="og:description" content="Solutions to exercises in Introduction to Algorithms chapter 22 - Elementary Graph Algorithms"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://server.duinomaker.top/blog/images/og_image.png"><meta property="article:published_time" content="2020-11-29T14:26:46.000Z"><meta property="article:modified_time" content="2020-11-30T08:20:15.000Z"><meta property="article:author" content="duinomaker"><meta property="article:tag" content="algorithm"><meta property="article:tag" content="programming"><meta property="article:tag" content="concrete mathematics"><meta property="article:tag" content="sicp"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://server.duinomaker.top/blog/images/og_image.png"><meta name="twitter:creator" content="@duinomaker"><meta name="twitter:site" content="@duinomaker"><meta property="fb:admins" content="100043022235251"><link rel="canonical" href="https://duinomaker.top/CLRS/exercises/22/"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://server.duinomaker.top/blog/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://server.duinomaker.top/blog/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://server.duinomaker.top/blog/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://server.duinomaker.top/blog/images/apple-touch-icon-144x144.png"><link rel="icon" type="image/svg+xml" href="https://server.duinomaker.top/blog/images/favicon.svg"><link rel="alternate icon" type="image/png" href="https://server.duinomaker.top/blog/images/favicon.png"><link rel="shortcut icon" type="image/x-icon" sizes="32x32" href="https://server.duinomaker.top/blog/images/favicon-32x32.ico"><link rel="shortcut icon" type="image/x-icon" sizes="16x16" href="https://server.duinomaker.top/blog/images/favicon-16x16.ico"><link rel="preload" href="https://server.duinomaker.top/blog/assets/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="preload" href="https://server.duinomaker.top/blog/assets/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@latest/css/bulma.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,italic,500,500italic|JetBrains+Mono|Alegreya:400,italic,500,500italic"><link rel="stylesheet" href="https://server.duinomaker.top/blog/assets/font-awesome/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><style>@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Roman"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunorm.woff) format("woff"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunorm.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Italic"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunoti.woff) format("woff"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunoti.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete Bold"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunobx.woff) format("woff"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunobx.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:"CMU Concrete";src:local("CMU Concrete BoldItalic"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunobi.woff) format("woff"),url(https://server.duinomaker.top/blog/assets/webfonts/cmu/cmunobi.ttf) format("truetype");font-weight:700;font-style:italic}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@latest/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://server.duinomaker.top/blog/assets/style.css"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand is-flex-center"> <a class="navbar-item navbar-logo" href="/"><img src="https://server.duinomaker.top/blog/images/misc/logo.svg" alt="Chapter 22 Elementary Graph Algorithms" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"> <a class="navbar-item" href="/">Home</a> <a class="navbar-item" href="/archives/">Archives</a> <a class="navbar-item" href="/categories/">Categories</a> <a class="navbar-item" href="/notes/">Notes</a> <a class="navbar-item" href="/about/">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column is-12 has-order-2 column-main"><div class="card"><div class="card-content article"><div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto"><div class="level-left"> <time class="level-item has-text-grey" datetime="2020-11-29T14:26:46.000Z">November 29, 2020</time><span class="level-item has-text-grey"><i class="fas fa-user"></i> &nbsp;<a class="has-link-grey" rel="author" href="https://duinomaker.top/">duinomaker</a></span></div></div><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal tex-math"> Chapter 22 Elementary Graph Algorithms</h1><div class="content has-math tex-math"><hr><h2 id="1-Representations-of-graphs"><a href="#1-Representations-of-graphs" class="headerlink" title="1 Representations of graphs"></a>1 Representations of graphs</h2><h3 id="22-1-1"><a href="#22-1-1" class="headerlink" title="22.1-1"></a>22.1-1</h3><p>$O(V+E)$, $O(V+E)$.</p><h3 id="22-1-2"><a href="#22-1-2" class="headerlink" title="22.1-2"></a>22.1-2</h3><pre><code>1 - 2, 3
2 - 1, 4, 5
3 - 1, 6, 7
4 - 2
5 - 2
6 - 3
7 - 3
</code></pre><h3 id="22-1-3"><a href="#22-1-3" class="headerlink" title="22.1-3"></a>22.1-3</h3><pre><code>let Adj&#39;[1..|G.V|] be a new adjacency list of transposed G
for each vertex u ∈ G.V
    for each vertex v ∈ G.Adj[u]
        INSERT(Adj&#39;[v], u)
</code></pre><h3 id="22-1-4"><a href="#22-1-4" class="headerlink" title="22.1-4"></a>22.1-4</h3><p>If we have a graph represented in adjacency-list form, transpose it, and the adjacency-list for each vertex is ordered. Transpose the transposed graph again, we’ll get the original graph but with adjacency-list for each vertex sorted. Merge the adjacency-lists of both “ordered” graphs at every vertex into new adjacency-lists, then the graph represented by these adjacency-lists is the desired undirected graph.</p><pre><code>TO_UNDIRECTED(G)
    let G^T = TRANSPOSED(G)
    let G = TRANSPOSED(G^T)
    let G_new be a new undirected equivalent graph to G
    G_new.Adj = a new adjacency list of length |G.V|
    for each vertex u in G.V
        G_new.Adj[u] = MERGE(G.Adj[u], G^T.Adj[u], u)
    return G_new

MERGE(List_1, List_2, ex)
    merge ordered lists List_1 and List_2 (with element ex excluded)
    into a single list and return it
</code></pre><h3 id="22-1-5"><a href="#22-1-5" class="headerlink" title="22.1-5"></a>22.1-5</h3><p>For adjacency-list representation:</p><pre><code>SQUARE(G)
    let G^2 be a new graph
    G^2.Adj = a new adjacency list of length |G.V|
    let E be a new hash set of edges of of G^2
    for each vertex u ∈ G.V
        for each vertex v ∈ G.V[u]
            for each vertex w ∈ G.V[v]
                INSERT(E, edge (u, w))
    for each edge e in E
        INSERT(G^2.Adj[e.from], e.to)
    return G^2
</code></pre><p>For adjacency-matrix representation, square the matrix and replace all non-zero elements with one.</p><p>The running time for both algorithms is $O(V^3)$.</p><h3 id="22-1-6"><a href="#22-1-6" class="headerlink" title="22.1-6"></a>22.1-6</h3><p>Denote the value of the $i$-th row and $j$-th column as $a_{i,j}$. Then if vertex $k$ is a universal sink, the graph must have the $k$-th row filled with $0$ and the $k$-th column filled with $1$ except for the $k$-th row.</p><p>We could find the universal as follows: Start from $a_{1,1}$. If the current entry $a_{i,j}$ is $0$, we let $j=j+1$ (move to the next column); otherwise $a_{i,j}$ is $1$, we let $i=i+1$ (move to the next row). Do this repeatedly until $j$ reaches $|V|$. Check if the final $j$ is a universal sink; if not, this means $G$ doesn’t contain a universal sink.</p><p>The running time is $O(V)$.</p><h3 id="22-1-7"><a href="#22-1-7" class="headerlink" title="22.1-7"></a>22.1-7</h3><p>Let $M=BB^{\rm T}$, then $M_{i,j}=\sum_{k=0}^{|E|}B_{i,k}B_{j,k}$. There are two types of values:</p><ol><li>if $i=j$, then $B_{i,k}B_{j,k}=1$ if edge $k$ leaves or enters vertex $i$;</li><li>otherwise $i\neq j$, then $B_{i,k}B_{j,k}=-1$ if and only if edge $k$ connects vertex $i$ and $j$.</li></ol><p>So, when summed up,</p><p>$$M_{i,j}=\begin{cases}\text{degree of vertex $i$}&amp;\text{if $i=j$,}\\-(\text{number of edges connecting $i$ and $j$})&amp;\text{if $i\neq j$.}\end{cases}$$</p><h3 id="22-1-8"><a href="#22-1-8" class="headerlink" title="22.1-8"></a>22.1-8</h3><p>The expected time is $O(1)$, the same as a hash table lookup. The disadvantage of using hash-tables is they take up more space than list.</p><p>We can use binary search trees to store lists of adjacent vertices; they takes up the same amount of spaces as lists, but the time complexity for both inserting a new vertex and for lookups is $O(\log V)$ instead of $O(1)$.</p><hr><h2 id="2-Breadth-first-search"><a href="#2-Breadth-first-search" class="headerlink" title="2 Breadth-first search"></a>2 Breadth-first search</h2><h3 id="22-2-1"><a href="#22-2-1" class="headerlink" title="22.2-1"></a>22.2-1</h3><table><thead><tr><th>$\text{vertex}$</th><th>$1$</th><th>$2$</th><th>$3$</th><th>$4$</th><th>$5$</th><th>$6$</th></tr></thead><tbody><tr><td>$d$</td><td>$\infty$</td><td>$3$</td><td>$0$</td><td>$2$</td><td>$1$</td><td>$1$</td></tr><tr><td>$\pi$</td><td>$\small{\text{NIL}}$</td><td>$4$</td><td>$\small{\text{NIL}}$</td><td>$5$</td><td>$3$</td><td>$3$</td></tr></tbody></table><h3 id="22-2-3"><a href="#22-2-3" class="headerlink" title="22.2-3"></a>22.2-3</h3><p>The book introduced gray to distinguish between enqueued and dequeued vertices. In fact, black and gray vertices have the same property, so it suffices to use just two colors, black and white.</p><h3 id="22-2-4"><a href="#22-2-4" class="headerlink" title="22.2-4"></a>22.2-4</h3><p>The running time for iterating all edges is $O(V^2)$, and $\Theta(V)$ queue operations are required. Therefore, the total running time is $O(V^2)$.</p><h3 id="22-2-5"><a href="#22-2-5" class="headerlink" title="22.2-5"></a>22.2-5</h3><p>Theorem 22.5 tells that upon termination of BFS on a graph $G$, we have $v.d=\delta(s,d)$ for any $s\in G.V$. This is an underlying property of the graph, no matter how we represent the graph.</p><h3 id="22-2-6"><a href="#22-2-6" class="headerlink" title="22.2-6"></a>22.2-6</h3><p>For example, for the directed graph $G=(V,E)$</p><pre><code>a-&gt;b&lt;-c
</code></pre><p>we have $E_\pi=E$. Clearly the set of edges $E_\pi$ cannot be obtained by running a BFS on it.</p><h3 id="22-2-7"><a href="#22-2-7" class="headerlink" title="22.2-7"></a>22.2-7</h3><pre><code>COLOR(G)
    for each vertex u ∈ G.V
        u.color = NONE
    for each vertex s ∈ G.V
        if s.color == NONE
            COLOR_FROM_SOURCE(G, s)

COLOR_FROM_SOURCE(G, s)
    s.color = WHITE
    Q = ∅
    ENQUEUE(Q, s)
    while Q != ∅
        u = DEQUEUE(Q)
        for each vertex v ∈ G.Adj[u]
            if v.color == NONE
                v.color = OPPOSITE_COLOR(u.color)
                ENQUEUE(Q, v)
            else if v.color == u.color
                print &quot;unable to designate&quot;

OPPOSITE_COLOR(color)
    return white if color is black and vice versa
</code></pre><p>Represent wrestlers as vertices and the existence of a rivalry as an undirected edge between two vertices. Thus, producing a graph $G=(V,E)$. After running the procedure <code>COLOR</code> on $G$, we will have the “color” of each wrestler as his property if it’s possible to designate, otherwise we will have “unable to designate” displayed on the screen.</p><h3 id="22-2-9"><a href="#22-2-9" class="headerlink" title="22.2-9"></a>22.2-9</h3><blockquote><p>TODO</p></blockquote></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5 has-text-weight-normal">Comments</h3><div id="valine-thread" class="content"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",notify:!1,verify:!1,app_id:"jUDJCYuOij3UzEzFmRpQer5U-gzGzoHsz",app_key:"h2AVOMeF8QsLYFdVVbbf9d7k",placeholder:"Suggestions are welcome.",lang:"en"})</script></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start has-text-centered-mobile has-mb-6-mobile"><p class="is-size-7">&copy;&nbsp;2020<span style="padding-left:.06em">–</span>2021&nbsp;duinomaker<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><i class="fas fa-file-word"></i>&nbsp;56.3k&nbsp;words in total<span>&nbsp;&nbsp;|&nbsp;&nbsp;</span><a class="has-link-black-ter" rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><i class="fab fa-creative-commons"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;&nbsp;<i class="fab fa-creative-commons-sa"></i></a></p></div><div class="level-end has-text-centered-mobile has-mb-5-mobile"><p>This work is licensed under a <a rel="license noopener external nofollow noreferrer" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons License</a></p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script>var IcarusThemeSettings={site:{url:"https://duinomaker.top",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!1,fold:"unfolded"}}}</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js" defer="defer"></script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js" defer="defer"></script><script>document.addEventListener("DOMContentLoaded",function(){for(contents=document.getElementsByClassName("has-math"),i=0;i<contents.length;++i)renderMathInElement(contents[i],{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script src="https://server.duinomaker.top/blog/assets/main.js" defer="defer"></script><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"https://server.duinomaker.top/blog/assets/content.json"}</script><script src="https://server.duinomaker.top/blog/assets/insight.js" defer="defer"></script><link rel="stylesheet" href="https://server.duinomaker.top/blog/assets/search.css"><link rel="stylesheet" href="https://server.duinomaker.top/blog/assets/insight.css"></body></html>